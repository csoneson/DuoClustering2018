<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plot performance summaries • DuoClustering2018</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plot performance summaries">
<meta property="og:description" content="DuoClustering2018">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DuoClustering2018</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/combine_data_clustering.html">Visualize data sets and clustering results with `iSEE`</a>
    </li>
    <li>
      <a href="../articles/plot_performance.html">Plot performance summaries</a>
    </li>
    <li>
      <a href="../articles/run_clustering.html">Apply clustering method</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plot performance summaries</h1>
                        <h4 data-toc-skip class="author">Angelo Duò</h4>
                                    <h4 data-toc-skip class="author">Mark D Robinson</h4>
                                    <h4 data-toc-skip class="author">Charlotte Soneson</h4>
                        
            <h4 data-toc-skip class="date">2022-10-21</h4>
      
      
      <div class="hidden name"><code>plot_performance.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we describe the basic usage of the <code>DuoClustering2018</code> package: how to retrieve data sets and clustering results, and how to construct various plots summarizing the performance of different methods across several data sets.</p>
</div>
<div class="section level2">
<h2 id="load-the-necessary-packages">Load the necessary packages<a class="anchor" aria-label="anchor" href="#load-the-necessary-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ExperimentHub</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DuoClustering2018</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## snapshotDate(): 2022-10-17</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="retrieve-a-data-set">Retrieve a data set<a class="anchor" aria-label="anchor" href="#retrieve-a-data-set"></a>
</h2>
<p>The clustering evaluation <span class="citation">(Duò, Robinson, and Soneson 2018)</span> is based on 12 data sets (9 real and 3 simulated), which are all provided via <code>ExperimentHub</code> and retrievable via this package. We include the full data sets (after quality filtering of cells and removal of genes with zero counts across all cells) as well as three filtered versions of each data set (by expression, variability and dropout pattern, respectively), each containing 10% of the genes in the full data set.</p>
<p>To get an overview, we can list all records from this package that are available in <code>ExperimentHub</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ExperimentHub/man/ExperimentHub-class.html" class="external-link">ExperimentHub</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## snapshotDate(): 2022-10-17</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html" class="external-link">query</a></span><span class="op">(</span><span class="va">eh</span>, <span class="st">"DuoClustering2018"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ExperimentHub with 122 records</span></span>
<span><span class="co">## # snapshotDate(): 2022-10-17</span></span>
<span><span class="co">## # $dataprovider: Robinson group (UZH), 10x Genomics, Zheng et al (2017), SRA...</span></span>
<span><span class="co">## # $species: Homo sapiens, Mus musculus, NA</span></span>
<span><span class="co">## # $rdataclass: data.frame, SingleCellExperiment, list</span></span>
<span><span class="co">## # additional mcols(): taxonomyid, genome, description,</span></span>
<span><span class="co">## #   coordinate_1_based, maintainer, rdatadateadded, preparerclass, tags,</span></span>
<span><span class="co">## #   rdatapath, sourceurl, sourcetype </span></span>
<span><span class="co">## # retrieve records with, e.g., 'object[["EH1499"]]' </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##            title                                               </span></span>
<span><span class="co">##   EH1499 | duo_clustering_all_parameter_settings_v1            </span></span>
<span><span class="co">##   EH1500 | sce_full_Koh                                        </span></span>
<span><span class="co">##   EH1501 | sce_filteredExpr10_Koh                              </span></span>
<span><span class="co">##   EH1502 | sce_filteredHVG10_Koh                               </span></span>
<span><span class="co">##   EH1503 | sce_filteredM3Drop10_Koh                            </span></span>
<span><span class="co">##   ...      ...                                                 </span></span>
<span><span class="co">##   EH1651 | clustering_summary_filteredHVG10_SimKumar4hard_v2   </span></span>
<span><span class="co">##   EH1652 | clustering_summary_filteredM3Drop10_SimKumar4hard_v2</span></span>
<span><span class="co">##   EH1653 | clustering_summary_filteredExpr10_SimKumar8hard_v2  </span></span>
<span><span class="co">##   EH1654 | clustering_summary_filteredHVG10_SimKumar8hard_v2   </span></span>
<span><span class="co">##   EH1655 | clustering_summary_filteredM3Drop10_SimKumar8hard_v2</span></span></code></pre>
<p>The records with names starting in <code>sce_</code> represent (filtered or unfiltered) data sets (in <code>SingleCellExperiment</code> format). The records with names starting in <code>clustering_summary_</code> correspond to <code>data.frame</code> objects with clustering results for each of the filtered data sets. Finally, the <code>duo_clustering_all_parameter_settings</code> object contains the parameter settings we used for all the clustering methods. For clustering summaries and parameter settings, the version number (e.g., <code>_v2</code>) corresponds to the version of the publication.</p>
<p>The records can be retrieved using their <code>ExperimentHub</code> ID, e.g.:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eh</span><span class="op">[[</span><span class="st">"EH1500"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## see ?DuoClustering2018 and browseVignettes('DuoClustering2018') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<pre><code><span><span class="co">## class: SingleCellExperiment </span></span>
<span><span class="co">## dim: 48981 531 </span></span>
<span><span class="co">## metadata(1): log.exprs.offset</span></span>
<span><span class="co">## assays(3): counts logcounts normcounts</span></span>
<span><span class="co">## rownames(48981): ENSG00000000003.14 ENSG00000000005.5 ...</span></span>
<span><span class="co">##   ENSG00000283122.1 ENSG00000283124.1</span></span>
<span><span class="co">## rowData names(8): is_feature_control mean_counts ... total_counts</span></span>
<span><span class="co">##   log10_total_counts</span></span>
<span><span class="co">## colnames(531): SRR3952323 SRR3952325 ... SRR3952970 SRR3952971</span></span>
<span><span class="co">## colData names(15): Run LibraryName ... feature.drop sizeFactor</span></span>
<span><span class="co">## reducedDimNames(2): PCA TSNE</span></span>
<span><span class="co">## mainExpName: NULL</span></span>
<span><span class="co">## altExpNames(0):</span></span></code></pre>
<p>Alternatively, the shortcut functions provided by this package can be used:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sce_full_Koh.html">sce_filteredExpr10_Koh</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## see ?DuoClustering2018 and browseVignettes('DuoClustering2018') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<pre><code><span><span class="co">## class: SingleCellExperiment </span></span>
<span><span class="co">## dim: 4898 531 </span></span>
<span><span class="co">## metadata(1): log.exprs.offset</span></span>
<span><span class="co">## assays(3): counts logcounts normcounts</span></span>
<span><span class="co">## rownames(4898): ENSG00000198804.2 ENSG00000210082.2 ...</span></span>
<span><span class="co">##   ENSG00000072134.15 ENSG00000090061.17</span></span>
<span><span class="co">## rowData names(8): is_feature_control mean_counts ... total_counts</span></span>
<span><span class="co">##   log10_total_counts</span></span>
<span><span class="co">## colnames(531): SRR3952323 SRR3952325 ... SRR3952970 SRR3952971</span></span>
<span><span class="co">## colData names(15): Run LibraryName ... is_cell_control sizeFactor</span></span>
<span><span class="co">## reducedDimNames(2): PCA TSNE</span></span>
<span><span class="co">## mainExpName: NULL</span></span>
<span><span class="co">## altExpNames(0):</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="read-a-set-of-clustering-results">Read a set of clustering results<a class="anchor" aria-label="anchor" href="#read-a-set-of-clustering-results"></a>
</h2>
<p>For each included data set, we have applied a range of clustering methods (see the <code>run_clustering</code> vignette for more details on how this was done, and how to apply additional methods). As mentioned above, the results of these clusterings are also available from <code>ExperimentHub</code>, and can be loaded either by their <code>ExperimentHub</code> ID or using the provided shortcut functions, as above. For simplicity, the results of all methods for a given data set are combined into a single object. As an illustration, we load the clustering summaries for two different data sets (<code>Koh</code> and <code>Zhengmix4eq</code>), each with two different gene filterings (<code>Expr10</code> and <code>HVG10</code>):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/rbind.fill.html" class="external-link">rbind.fill</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/clustering_summary_v2.html">clustering_summary_filteredExpr10_Koh_v2</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/clustering_summary_v2.html">clustering_summary_filteredHVG10_Koh_v2</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/clustering_summary_v2.html">clustering_summary_filteredExpr10_Zhengmix4eq_v2</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/clustering_summary_v2.html">clustering_summary_filteredHVG10_Zhengmix4eq_v2</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## see ?DuoClustering2018 and browseVignettes('DuoClustering2018') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<pre><code><span><span class="co">## see ?DuoClustering2018 and browseVignettes('DuoClustering2018') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<pre><code><span><span class="co">## see ?DuoClustering2018 and browseVignettes('DuoClustering2018') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<pre><code><span><span class="co">## see ?DuoClustering2018 and browseVignettes('DuoClustering2018') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5625885      10</span></span></code></pre>
<p>The resulting <code>data.frame</code> contains 10 columns:</p>
<ul>
<li>
<code>dataset</code>: The name of the data set</li>
<li>
<code>method</code>: The name of the clustering method</li>
<li>
<code>cell</code>: The cell identifier</li>
<li>
<code>run</code>: The run ID (each method was run five times for each data set and number of clusters)</li>
<li>
<code>k</code>: The imposed number of clusters (for all methods except Seurat)</li>
<li>
<code>resolution</code>: The imposed resolution (only for Seurat)</li>
<li>
<code>cluster</code>: The assigned cluster label</li>
<li>
<code>trueclass</code>: The true class of the cell</li>
<li>
<code>est_k</code>: The estimated number of clusters (for methods allowing such estimation)</li>
<li>
<code>elapsed</code>: The elapsed time of the run</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                  dataset    method       cell run k resolution cluster</span></span>
<span><span class="co">## 1 sce_filteredExpr10_Koh PCAKmeans SRR3952323   1 2         NA       1</span></span>
<span><span class="co">## 2 sce_filteredExpr10_Koh PCAKmeans SRR3952325   1 2         NA       1</span></span>
<span><span class="co">## 3 sce_filteredExpr10_Koh PCAKmeans SRR3952326   1 2         NA       1</span></span>
<span><span class="co">## 4 sce_filteredExpr10_Koh PCAKmeans SRR3952327   1 2         NA       1</span></span>
<span><span class="co">## 5 sce_filteredExpr10_Koh PCAKmeans SRR3952328   1 2         NA       1</span></span>
<span><span class="co">## 6 sce_filteredExpr10_Koh PCAKmeans SRR3952329   1 2         NA       1</span></span>
<span><span class="co">##   trueclass est_k elapsed</span></span>
<span><span class="co">## 1    H7hESC    NA  14.318</span></span>
<span><span class="co">## 2    H7hESC    NA  14.318</span></span>
<span><span class="co">## 3    H7hESC    NA  14.318</span></span>
<span><span class="co">## 4    H7hESC    NA  14.318</span></span>
<span><span class="co">## 5    H7hESC    NA  14.318</span></span>
<span><span class="co">## 6    H7hESC    NA  14.318</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="define-consistent-method-colors">Define consistent method colors<a class="anchor" aria-label="anchor" href="#define-consistent-method-colors"></a>
</h2>
<p>For some of the plots generated below, the points will be colored according to the clustering method. We can enforce a consistent set of colors for the methods by defining a named vector of colors to use for all plots.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CIDR <span class="op">=</span> <span class="st">"#332288"</span>, FlowSOM <span class="op">=</span> <span class="st">"#6699CC"</span>, PCAHC <span class="op">=</span> <span class="st">"#88CCEE"</span>, </span>
<span>            PCAKmeans <span class="op">=</span> <span class="st">"#44AA99"</span>, pcaReduce <span class="op">=</span> <span class="st">"#117733"</span>,</span>
<span>            RtsneKmeans <span class="op">=</span> <span class="st">"#999933"</span>, Seurat <span class="op">=</span> <span class="st">"#DDCC77"</span>, SC3svm <span class="op">=</span> <span class="st">"#661100"</span>, </span>
<span>            SC3 <span class="op">=</span> <span class="st">"#CC6677"</span>, TSCAN <span class="op">=</span> <span class="st">"grey34"</span>, ascend <span class="op">=</span> <span class="st">"orange"</span>, SAFE <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>            monocle <span class="op">=</span> <span class="st">"red"</span>, RaceID2 <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h2>
<p>Each plotting function described below returns a list of <code>ggplot</code> objects. These can be plotted directly, or further modified if desired.</p>
<div class="section level3">
<h3 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h3>
<p>The <code><a href="../reference/plot_performance.html">plot_performance()</a></code> function generates plots related to the performance of the clustering methods. We quantify performance using the adjusted Rand Index (ARI) <span class="citation">(Hubert and Arabie 1985)</span>, comparing the obtained clustering to the true clusters. As we noted in the publication <span class="citation">(Duò, Robinson, and Soneson 2018)</span>, defining a true partitioning of the cells is difficult, since they can often be grouped together in several different, but still interpretable, ways. We refer to our paper for more information on how the true clusters were defined for each of the data sets.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_performance.html">plot_performance</a></span><span class="op">(</span><span class="va">res</span>, method_colors <span class="op">=</span> <span class="va">method_colors</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">perf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "median_ari_vs_k"           "scatter_time_vs_ari_truek"</span></span>
<span><span class="co">## [3] "median_ari_heatmap_truek"  "median_ari_heatmap_bestk" </span></span>
<span><span class="co">## [5] "median_ari_heatmap_estk"</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf</span><span class="op">$</span><span class="va">median_ari_vs_k</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 4 row(s) containing missing values (geom_path).</span></span></code></pre>
<p><img src="plot_performance_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf</span><span class="op">$</span><span class="va">median_ari_heatmap_truek</span></span></code></pre></div>
<p><img src="plot_performance_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="stability">Stability<a class="anchor" aria-label="anchor" href="#stability"></a>
</h3>
<p>The <code><a href="../reference/plot_stability.html">plot_stability()</a></code> function evaluates the stability of the clustering results from each method, with respect to random starts. Each method was run five times on each data set (for each k), and we quantify the stability by comparing each pair of such runs using the adjusted Rand Index.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_stability.html">plot_stability</a></span><span class="op">(</span><span class="va">res</span>, method_colors <span class="op">=</span> <span class="va">method_colors</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span>
<span><span class="co">## Aggregation function missing: defaulting to length</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `cols` is now required when using unnest().</span></span>
<span><span class="co">## Please use `cols = c(stability)`</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">stab</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "stability_vs_k"          "stability_truek"        </span></span>
<span><span class="co">## [3] "stability_heatmap_truek"</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stab</span><span class="op">$</span><span class="va">stability_vs_k</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 4 row(s) containing missing values (geom_path).</span></span></code></pre>
<p><img src="plot_performance_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stab</span><span class="op">$</span><span class="va">stability_heatmap_truek</span></span></code></pre></div>
<p><img src="plot_performance_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="entropy">Entropy<a class="anchor" aria-label="anchor" href="#entropy"></a>
</h3>
<p>In order to evaluate the tendency of the clustering methods to favor equally sized clusters, we calculate the Shannon entropy <span class="citation">(Shannon 1948)</span> of each clustering solution (based on the proportions of cells in the different clusters) and plot this using the <code><a href="../reference/plot_entropy.html">plot_entropy()</a></code> function. Since the maximal entropy that can be obtained depends on the number of clusters, we use normalized entropies, defined by dividing the observed entropy by <code>log2(k)</code>. We also compare the entropies for the clusterings to the entropy of the true partition for each data set.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">entr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_entropy.html">plot_entropy</a></span><span class="op">(</span><span class="va">res</span>, method_colors <span class="op">=</span> <span class="va">method_colors</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">entr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "entropy_vs_k"           "entropy_vs_ari"         "normentropy"           </span></span>
<span><span class="co">## [4] "deltaentropy_truek"     "deltanormentropy_truek"</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">entr</span><span class="op">$</span><span class="va">entropy_vs_k</span></span></code></pre></div>
<p><img src="plot_performance_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">entr</span><span class="op">$</span><span class="va">normentropy</span></span></code></pre></div>
<p><img src="plot_performance_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="timing">Timing<a class="anchor" aria-label="anchor" href="#timing"></a>
</h3>
<p>The <code><a href="../reference/plot_timing.html">plot_timing()</a></code> function plots various aspects of the timing of the different methods.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_timing.html">plot_timing</a></span><span class="op">(</span><span class="va">res</span>, method_colors <span class="op">=</span> <span class="va">method_colors</span>, </span>
<span>                      scaleMethod <span class="op">=</span> <span class="st">"RtsneKmeans"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">timing</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "time_boxplot"           "time_normalized_by_ref" "time_vs_k"</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timing</span><span class="op">$</span><span class="va">time_normalized_by_ref</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 32 rows containing non-finite values (stat_boxplot).</span></span></code></pre>
<p><img src="plot_performance_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="differences-in-k">Differences in k<a class="anchor" aria-label="anchor" href="#differences-in-k"></a>
</h3>
<p>Most performance evaluations above are performed on the clustering solutions obtained by imposing the “true” number of clusters. The <code><a href="../reference/plot_k_diff.html">plot_k_diff()</a></code> function evaluates the difference between the true number of cluster and the number of clusters giving the best agreement with the true partition, as well as the difference between the estimated and the true number of clusters, for the methods that allow estimation of k.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kdiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_k_diff.html">plot_k_diff</a></span><span class="op">(</span><span class="va">res</span>, method_colors <span class="op">=</span> <span class="va">method_colors</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kdiff</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "diff_kmax_ktrue" "diff_kest_ktrue"</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kdiff</span><span class="op">$</span><span class="va">diff_kest_ktrue</span></span></code></pre></div>
<pre><code><span><span class="co">## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`.</span></span></code></pre>
<p><img src="plot_performance_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Big Sur ... 10.16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib</span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] plyr_1.8.7                  DuoClustering2018_1.7.1    </span></span>
<span><span class="co">##  [3] SingleCellExperiment_1.19.1 SummarizedExperiment_1.27.3</span></span>
<span><span class="co">##  [5] Biobase_2.57.1              GenomicRanges_1.49.1       </span></span>
<span><span class="co">##  [7] GenomeInfoDb_1.33.13        IRanges_2.31.2             </span></span>
<span><span class="co">##  [9] S4Vectors_0.35.4            MatrixGenerics_1.9.1       </span></span>
<span><span class="co">## [11] matrixStats_0.62.0          ExperimentHub_2.5.0        </span></span>
<span><span class="co">## [13] AnnotationHub_3.5.2         BiocFileCache_2.5.2        </span></span>
<span><span class="co">## [15] dbplyr_2.2.1                BiocGenerics_0.43.4        </span></span>
<span><span class="co">## [17] BiocStyle_2.25.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] bitops_1.0-7                  fs_1.5.2                     </span></span>
<span><span class="co">##  [3] bit64_4.0.5                   filelock_1.0.2               </span></span>
<span><span class="co">##  [5] httr_1.4.4                    rprojroot_2.0.3              </span></span>
<span><span class="co">##  [7] tools_4.2.1                   bslib_0.4.0                  </span></span>
<span><span class="co">##  [9] utf8_1.2.2                    R6_2.5.1                     </span></span>
<span><span class="co">## [11] DBI_1.1.3                     colorspace_2.0-3             </span></span>
<span><span class="co">## [13] withr_2.5.0                   gridExtra_2.3                </span></span>
<span><span class="co">## [15] tidyselect_1.2.0              bit_4.0.4                    </span></span>
<span><span class="co">## [17] curl_4.3.3                    compiler_4.2.1               </span></span>
<span><span class="co">## [19] textshaping_0.3.6             cli_3.4.1                    </span></span>
<span><span class="co">## [21] desc_1.4.2                    DelayedArray_0.23.2          </span></span>
<span><span class="co">## [23] labeling_0.4.2                bookdown_0.29                </span></span>
<span><span class="co">## [25] sass_0.4.2                    scales_1.2.1                 </span></span>
<span><span class="co">## [27] rappdirs_0.3.3                pkgdown_2.0.6.9000           </span></span>
<span><span class="co">## [29] systemfonts_1.0.4             stringr_1.4.1                </span></span>
<span><span class="co">## [31] digest_0.6.30                 rmarkdown_2.17               </span></span>
<span><span class="co">## [33] XVector_0.37.1                pkgconfig_2.0.3              </span></span>
<span><span class="co">## [35] htmltools_0.5.3               highr_0.9                    </span></span>
<span><span class="co">## [37] fastmap_1.1.0                 ggthemes_4.2.4               </span></span>
<span><span class="co">## [39] rlang_1.0.6                   RSQLite_2.2.18               </span></span>
<span><span class="co">## [41] shiny_1.7.2                   farver_2.1.1                 </span></span>
<span><span class="co">## [43] jquerylib_0.1.4               generics_0.1.3               </span></span>
<span><span class="co">## [45] jsonlite_1.8.2                mclust_5.4.10                </span></span>
<span><span class="co">## [47] dplyr_1.0.10                  RCurl_1.98-1.9               </span></span>
<span><span class="co">## [49] magrittr_2.0.3                GenomeInfoDbData_1.2.9       </span></span>
<span><span class="co">## [51] Matrix_1.5-1                  Rcpp_1.0.9                   </span></span>
<span><span class="co">## [53] munsell_0.5.0                 fansi_1.0.3                  </span></span>
<span><span class="co">## [55] viridis_0.6.2                 lifecycle_1.0.3              </span></span>
<span><span class="co">## [57] stringi_1.7.8                 yaml_2.3.6                   </span></span>
<span><span class="co">## [59] zlibbioc_1.43.0               grid_4.2.1                   </span></span>
<span><span class="co">## [61] blob_1.2.3                    promises_1.2.0.1             </span></span>
<span><span class="co">## [63] crayon_1.5.2                  lattice_0.20-45              </span></span>
<span><span class="co">## [65] Biostrings_2.65.6             KEGGREST_1.37.3              </span></span>
<span><span class="co">## [67] knitr_1.40                    pillar_1.8.1                 </span></span>
<span><span class="co">## [69] reshape2_1.4.4                glue_1.6.2                   </span></span>
<span><span class="co">## [71] BiocVersion_3.16.0            evaluate_0.17                </span></span>
<span><span class="co">## [73] BiocManager_1.30.18           png_0.1-7                    </span></span>
<span><span class="co">## [75] vctrs_0.4.2                   httpuv_1.6.6                 </span></span>
<span><span class="co">## [77] tidyr_1.2.1                   gtable_0.3.1                 </span></span>
<span><span class="co">## [79] purrr_0.3.5                   assertthat_0.2.1             </span></span>
<span><span class="co">## [81] cachem_1.0.6                  ggplot2_3.3.6                </span></span>
<span><span class="co">## [83] xfun_0.34                     mime_0.12                    </span></span>
<span><span class="co">## [85] xtable_1.8-4                  later_1.3.0                  </span></span>
<span><span class="co">## [87] viridisLite_0.4.1             ragg_1.2.3                   </span></span>
<span><span class="co">## [89] tibble_3.1.8                  AnnotationDbi_1.59.1         </span></span>
<span><span class="co">## [91] memoise_2.0.1                 ellipsis_0.3.2               </span></span>
<span><span class="co">## [93] interactiveDisplayBase_1.35.1</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Duo2018-F1000" class="csl-entry">
Duò, A, MD Robinson, and D Soneson. 2018. <span>“A Systematic Performance Evaluation of Clustering Methods for Single-Cell <span class="nocase">RNA-seq</span> Data.”</span> <em>F1000Research</em> 7: 1141.
</div>
<div id="ref-hubert1985comparing" class="csl-entry">
Hubert, L, and P Arabie. 1985. <span>“Comparing Partitions.”</span> <em>Journal of Classification</em> 2 (1): 193–218.
</div>
<div id="ref-Shannon1948-cw" class="csl-entry">
Shannon, C E. 1948. <span>“A Mathematical Theory of Communication.”</span> <em>The Bell System Technical Journal</em> 27 (3): 379–423.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Angelo Duò, Charlotte Soneson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
