<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apply clustering method • DuoClustering2018</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Apply clustering method">
<meta property="og:description" content="DuoClustering2018">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DuoClustering2018</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/combine_data_clustering.html">Visualize data sets and clustering results with `iSEE`</a>
    </li>
    <li>
      <a href="../articles/plot_performance.html">Plot performance summaries</a>
    </li>
    <li>
      <a href="../articles/run_clustering.html">Apply clustering method</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Apply clustering method</h1>
                        <h4 data-toc-skip class="author">Angelo Duò</h4>
                                    <h4 data-toc-skip class="author">Mark
D Robinson</h4>
                                    <h4 data-toc-skip class="author">Charlotte
Soneson</h4>
                        
            <h4 data-toc-skip class="date">2023-06-24</h4>
      
      
      <div class="hidden name"><code>run_clustering.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes how each of the included clustering methods
was applied to the collection of data sets in order to generate the
clustering result summaries provided with the package. It also shows how
to apply a new clustering method to the included data sets, to generate
results that can be compared to those already included.</p>
</div>
<div class="section level2">
<h2 id="applying-a-new-clustering-algorithm-to-a-provided-data-set">Applying a new clustering algorithm to a provided data set<a class="anchor" aria-label="anchor" href="#applying-a-new-clustering-algorithm-to-a-provided-data-set"></a>
</h2>
<p>The code below describes how we applied each of the included
clustering methods to the data sets for our paper <span class="citation">(Duò, Robinson, and Soneson 2018)</span>. The
<code>apply_*()</code> functions, describing how the respective
clustering methods were run, are available from the <a href="https://github.com/markrobinsonuzh/scRNAseq_clustering_comparison/tree/master/Rscripts/clustering" class="external-link">GitHub
repository</a> corresponding to the publication. In order to apply a new
clustering algorithm to one of the data sets using the same framework,
it is necessary to generate a function with the same format. The input
arguments to this function should be:</p>
<ul>
<li>a <code>SingleCellExperiment</code> object</li>
<li>a named list of parameter values (can be empty, if no parameters are
used for the method)</li>
<li>the desired number of clusters (k).</li>
</ul>
<p>The function should return a list with three elements:</p>
<ul>
<li>
<code>st</code> - a vector with the timing information. Should have
five elements, named <code>user.self</code>, <code>sys.self</code>,
<code>user.child</code>, <code>sys.child</code> and
<code>elapsed</code>.</li>
<li>
<code>cluster</code> - a named vector of cluster assignments for all
cells.</li>
<li>
<code>est_k</code> - the number of clusters estimated by the method
(if available, otherwise <code>NA</code>).</li>
</ul>
<p>If the method does not allow specification of the desired number of
clusters, but has another parameter affecting the resolution, this can
be accommodated as well (see the solution for <code>Seurat</code> in the
code below).</p>
<p>First, load the package and define the data set and clustering method
to use (note that in order to apply a method named
<code>&lt;method&gt;</code>, there has to be a function named
<code>apply_&lt;method&gt;()</code>, with the above specifications,
available in the workspace).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DuoClustering2018</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scename</span> <span class="op">&lt;-</span> <span class="st">"sce_filteredExpr10_Koh"</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sce_full_Koh.html">sce_filteredExpr10_Koh</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## see ?DuoClustering2018 and browseVignettes('DuoClustering2018') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<pre><code><span><span class="co">## require("SingleCellExperiment")</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"PCAHC"</span></span></code></pre></div>
<p>Next, define the list of hyperparameter values. The package contains
the hyperparameter values for the methods included in our paper.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load parameter files. General dataset and method parameters as well as</span></span>
<span><span class="co">## dataset/method-specific parameters</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/duo_clustering_all_parameter_settings_v2.html">duo_clustering_all_parameter_settings_v2</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">scename</span>, <span class="st">"_"</span>, </span>
<span>                                                             <span class="va">method</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## see ?DuoClustering2018 and browseVignettes('DuoClustering2018') for documentation</span></span></code></pre>
<pre><code><span><span class="co">## loading from cache</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span></span></code></pre></div>
<pre><code><span><span class="co">## $nPC</span></span>
<span><span class="co">## [1] 30</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $range_clusters</span></span>
<span><span class="co">##  [1]  2  3  4  5  6  7  8  9 10 11 12 13 14 15</span></span></code></pre>
<p>Finally, define the number of times to apply the clustering method
(for each value of the number of clusters), and run the clustering
across a range of imposed numbers of clusters (defined in the parameter
list).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Set number of times to run clustering for each k</span></span>
<span><span class="va">n_rep</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co">## Run clustering</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_rep</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>  <span class="co">## For each run</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"run = "</span>, <span class="va">i</span>, <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"Seurat"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">range_resolutions</span>, <span class="kw">function</span><span class="op">(</span><span class="va">resolution</span><span class="op">)</span> <span class="op">{</span>  </span>
<span>      <span class="co">## For each resolution</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"resolution = "</span>, <span class="va">resolution</span>, <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="co">## Run clustering</span></span>
<span>      <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html" class="external-link">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"apply_"</span>, <span class="va">method</span><span class="op">)</span><span class="op">)</span><span class="op">(</span>sce <span class="op">=</span> <span class="va">sce</span>, params <span class="op">=</span> <span class="va">params</span>, </span>
<span>                                           resolution <span class="op">=</span> <span class="va">resolution</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co">## Put output in data frame</span></span>
<span>      <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">scename</span>, </span>
<span>                       method <span class="op">=</span> <span class="va">method</span>, </span>
<span>                       cell <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span>,</span>
<span>                       run <span class="op">=</span> <span class="va">i</span>,</span>
<span>                       k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       resolution <span class="op">=</span> <span class="va">resolution</span>,</span>
<span>                       cluster <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>                       stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>      <span class="va">tm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">scename</span>, </span>
<span>                       method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                       run <span class="op">=</span> <span class="va">i</span>, </span>
<span>                       k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       resolution <span class="op">=</span> <span class="va">resolution</span>,</span>
<span>                       user.self <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">st</span><span class="op">[[</span><span class="st">"user.self"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       sys.self <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">st</span><span class="op">[[</span><span class="st">"sys.self"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       user.child <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">st</span><span class="op">[[</span><span class="st">"user.child"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       sys.child <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">st</span><span class="op">[[</span><span class="st">"sys.child"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       elapsed <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">st</span><span class="op">[[</span><span class="st">"elapsed"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>      <span class="va">kest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">scename</span>, </span>
<span>                         method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                         run <span class="op">=</span> <span class="va">i</span>, </span>
<span>                         k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                         resolution <span class="op">=</span> <span class="va">resolution</span>,</span>
<span>                         est_k <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">est_k</span>,</span>
<span>                         stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>clusters <span class="op">=</span> <span class="va">df</span>, timing <span class="op">=</span> <span class="va">tm</span>, kest <span class="op">=</span> <span class="va">kest</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span>  <span class="co">## End for each resolution</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">params</span><span class="op">$</span><span class="va">range_clusters</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span>  <span class="co">## For each k</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"k = "</span>, <span class="va">k</span>, <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="co">## Run clustering</span></span>
<span>      <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html" class="external-link">get</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"apply_"</span>, <span class="va">method</span><span class="op">)</span><span class="op">)</span><span class="op">(</span>sce <span class="op">=</span> <span class="va">sce</span>, params <span class="op">=</span> <span class="va">params</span>, k <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co">## Put output in data frame</span></span>
<span>      <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">scename</span>, </span>
<span>                       method <span class="op">=</span> <span class="va">method</span>, </span>
<span>                       cell <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span>,</span>
<span>                       run <span class="op">=</span> <span class="va">i</span>,</span>
<span>                       k <span class="op">=</span> <span class="va">k</span>,</span>
<span>                       resolution <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                       cluster <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>                       stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>      <span class="va">tm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">scename</span>, </span>
<span>                       method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                       run <span class="op">=</span> <span class="va">i</span>, </span>
<span>                       k <span class="op">=</span> <span class="va">k</span>,</span>
<span>                       resolution <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                       user.self <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">st</span><span class="op">[[</span><span class="st">"user.self"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       sys.self <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">st</span><span class="op">[[</span><span class="st">"sys.self"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       user.child <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">st</span><span class="op">[[</span><span class="st">"user.child"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       sys.child <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">st</span><span class="op">[[</span><span class="st">"sys.child"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       elapsed <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">st</span><span class="op">[[</span><span class="st">"elapsed"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>      <span class="va">kest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">scename</span>, </span>
<span>                         method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                         run <span class="op">=</span> <span class="va">i</span>, </span>
<span>                         k <span class="op">=</span> <span class="va">k</span>,</span>
<span>                         resolution <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                         est_k <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">est_k</span>,</span>
<span>                         stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>clusters <span class="op">=</span> <span class="va">df</span>, timing <span class="op">=</span> <span class="va">tm</span>, kest <span class="op">=</span> <span class="va">kest</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span>  <span class="co">## End for each k</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co">## Summarize across different values of k</span></span>
<span>  <span class="va">assignments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="va">w</span><span class="op">$</span><span class="va">clusters</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">timings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="va">w</span><span class="op">$</span><span class="va">timing</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">k_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="va">w</span><span class="op">$</span><span class="va">kest</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>assignments <span class="op">=</span> <span class="va">assignments</span>, timings <span class="op">=</span> <span class="va">timings</span>, k_estimates <span class="op">=</span> <span class="va">k_estimates</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span>  <span class="co">## End for each run</span></span>
<span></span>
<span><span class="co">## Summarize across different runs</span></span>
<span><span class="va">assignments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">L</span>, <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="va">w</span><span class="op">$</span><span class="va">assignments</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">timings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">L</span>, <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="va">w</span><span class="op">$</span><span class="va">timings</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">k_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">L</span>, <span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="va">w</span><span class="op">$</span><span class="va">k_estimates</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Add true group for each cell</span></span>
<span><span class="va">truth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    trueclass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">$</span><span class="va">phenoid</span><span class="op">)</span>,</span>
<span>                    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">assignments</span><span class="op">$</span><span class="va">trueclass</span> <span class="op">&lt;-</span> <span class="va">truth</span><span class="op">$</span><span class="va">trueclass</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">assignments</span><span class="op">$</span><span class="va">cell</span>, <span class="va">truth</span><span class="op">$</span><span class="va">cell</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Combine results</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>assignments <span class="op">=</span> <span class="va">assignments</span>, timings <span class="op">=</span> <span class="va">timings</span>,</span>
<span>            k_estimates <span class="op">=</span> <span class="va">k_estimates</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">assignments</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">method</span>, <span class="va">cell</span>, <span class="va">run</span>, <span class="va">k</span>, </span>
<span>                                       <span class="va">resolution</span>, <span class="va">cluster</span>, <span class="va">trueclass</span><span class="op">)</span>,</span>
<span>                       <span class="va">res</span><span class="op">$</span><span class="va">k_estimates</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">method</span>, <span class="va">run</span>, <span class="va">k</span>, </span>
<span>                                       <span class="va">resolution</span>, <span class="va">est_k</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">timings</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">method</span>, <span class="va">run</span>, <span class="va">k</span>,</span>
<span>                                                     <span class="va">resolution</span>, <span class="va">elapsed</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The resulting <code>df</code> data frames can then be combined across
data sets, filterings and methods and used as input to the provided
plotting functions.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Monterey 12.6.6</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] SingleCellExperiment_1.23.0 SummarizedExperiment_1.31.1</span></span>
<span><span class="co">##  [3] Biobase_2.61.0              GenomicRanges_1.53.1       </span></span>
<span><span class="co">##  [5] GenomeInfoDb_1.37.2         IRanges_2.35.2             </span></span>
<span><span class="co">##  [7] S4Vectors_0.39.1            BiocGenerics_0.47.0        </span></span>
<span><span class="co">##  [9] MatrixGenerics_1.13.0       matrixStats_1.0.0          </span></span>
<span><span class="co">## [11] DuoClustering2018_1.7.1     BiocStyle_2.29.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] DBI_1.1.3                     bitops_1.0-7                 </span></span>
<span><span class="co">##  [3] gridExtra_2.3                 rlang_1.1.1                  </span></span>
<span><span class="co">##  [5] magrittr_2.0.3                compiler_4.3.1               </span></span>
<span><span class="co">##  [7] RSQLite_2.3.1                 png_0.1-8                    </span></span>
<span><span class="co">##  [9] systemfonts_1.0.4             vctrs_0.6.3                  </span></span>
<span><span class="co">## [11] reshape2_1.4.4                stringr_1.5.0                </span></span>
<span><span class="co">## [13] pkgconfig_2.0.3               crayon_1.5.2                 </span></span>
<span><span class="co">## [15] fastmap_1.1.1                 dbplyr_2.3.2                 </span></span>
<span><span class="co">## [17] XVector_0.41.1                ellipsis_0.3.2               </span></span>
<span><span class="co">## [19] utf8_1.2.3                    promises_1.2.0.1             </span></span>
<span><span class="co">## [21] rmarkdown_2.22                ragg_1.2.5                   </span></span>
<span><span class="co">## [23] purrr_1.0.1                   bit_4.0.5                    </span></span>
<span><span class="co">## [25] xfun_0.39                     zlibbioc_1.47.0              </span></span>
<span><span class="co">## [27] cachem_1.0.8                  jsonlite_1.8.5               </span></span>
<span><span class="co">## [29] blob_1.2.4                    later_1.3.1                  </span></span>
<span><span class="co">## [31] DelayedArray_0.27.5           interactiveDisplayBase_1.39.0</span></span>
<span><span class="co">## [33] R6_2.5.1                      bslib_0.5.0                  </span></span>
<span><span class="co">## [35] stringi_1.7.12                jquerylib_0.1.4              </span></span>
<span><span class="co">## [37] Rcpp_1.0.10                   bookdown_0.34                </span></span>
<span><span class="co">## [39] knitr_1.43                    Matrix_1.5-4.1               </span></span>
<span><span class="co">## [41] httpuv_1.6.11                 tidyselect_1.2.0             </span></span>
<span><span class="co">## [43] yaml_2.3.7                    viridis_0.6.3                </span></span>
<span><span class="co">## [45] curl_5.0.1                    lattice_0.21-8               </span></span>
<span><span class="co">## [47] tibble_3.2.1                  plyr_1.8.8                   </span></span>
<span><span class="co">## [49] shiny_1.7.4                   withr_2.5.0                  </span></span>
<span><span class="co">## [51] KEGGREST_1.41.0               evaluate_0.21                </span></span>
<span><span class="co">## [53] desc_1.4.2                    BiocFileCache_2.9.0          </span></span>
<span><span class="co">## [55] ExperimentHub_2.9.0           mclust_6.0.0                 </span></span>
<span><span class="co">## [57] Biostrings_2.69.1             pillar_1.9.0                 </span></span>
<span><span class="co">## [59] BiocManager_1.30.21           filelock_1.0.2               </span></span>
<span><span class="co">## [61] generics_0.1.3                rprojroot_2.0.3              </span></span>
<span><span class="co">## [63] RCurl_1.98-1.12               BiocVersion_3.18.0           </span></span>
<span><span class="co">## [65] ggplot2_3.4.2                 munsell_0.5.0                </span></span>
<span><span class="co">## [67] scales_1.2.1                  xtable_1.8-4                 </span></span>
<span><span class="co">## [69] glue_1.6.2                    tools_4.3.1                  </span></span>
<span><span class="co">## [71] AnnotationHub_3.9.1           fs_1.6.2                     </span></span>
<span><span class="co">## [73] grid_4.3.1                    tidyr_1.3.0                  </span></span>
<span><span class="co">## [75] AnnotationDbi_1.63.1          colorspace_2.1-0             </span></span>
<span><span class="co">## [77] GenomeInfoDbData_1.2.10       cli_3.6.1                    </span></span>
<span><span class="co">## [79] rappdirs_0.3.3                textshaping_0.3.6            </span></span>
<span><span class="co">## [81] fansi_1.0.4                   ggthemes_4.2.4               </span></span>
<span><span class="co">## [83] S4Arrays_1.1.4                viridisLite_0.4.2            </span></span>
<span><span class="co">## [85] dplyr_1.1.2                   gtable_0.3.3                 </span></span>
<span><span class="co">## [87] sass_0.4.6                    digest_0.6.31                </span></span>
<span><span class="co">## [89] SparseArray_1.1.10            memoise_2.0.1                </span></span>
<span><span class="co">## [91] htmltools_0.5.5               pkgdown_2.0.7.9000           </span></span>
<span><span class="co">## [93] lifecycle_1.0.3               httr_1.4.6                   </span></span>
<span><span class="co">## [95] mime_0.12                     bit64_4.0.5</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Duo2018-F1000" class="csl-entry">
Duò, A, MD Robinson, and D Soneson. 2018. <span>“A Systematic
Performance Evaluation of Clustering Methods for Single-Cell <span class="nocase">RNA-seq</span> Data.”</span> <em>F1000Research</em> 7:
1141.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Angelo Duò, Charlotte Soneson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
